import pandas as pd
import time
def load_data(path):
    df = pd.read_csv(path)
    print("Data loaded")
    print(df.head())
    return df
def inspect_data(df):
    print("\nData info:")
    print(df.info())
    print("\nMissing values:")
    print(df.isna().sum())
    print("\nSummary stats:")
    print(df.describe())
def clean_numeric(df):
    if "age" in df.columns:
        df["age"] = pd.to_numeric(df["age"], errors="coerce")
        df["age"].fillna(df["age"].median(), inplace=True)
    if "income" in df.columns:
        df["income"] = pd.to_numeric(df["income"], errors="coerce")
        df["income"].fillna(df["income"].median(), inplace=True)
        cap = df["income"].quantile(0.99)
        df["income"] = df["income"].clip(upper=cap)
    return df
def clean_text(df):
    if "city" in df.columns:
        df["city"] = df["city"].str.strip().str.lower()
    return df
def clean_dates(df):
    if "signup_time" in df.columns:
        df["signup_time"] = pd.to_datetime(df["signup_time"], errors="coerce")
        df["hour"] = df["signup_time"].dt.hour
        df["day"] = df["signup_time"].dt.day_name()
    return df
def remove_duplicates(df):
    before = len(df)
    df = df.drop_duplicates()
    after = len(df)
    print("Duplicates removed:", before - after)
    return df
def validate(df):
    print("\nFinal missing values:")
    print(df.isna().sum())
    print("\nFinal summary:")
    print(df.describe())
def clean_data_project(path_in, path_out):
    start = time.time()
    df = load_data(path_in)
    inspect_data(df)
    df = clean_numeric(df)
    df = clean_text(df)
    df = clean_dates(df)
    df = remove_duplicates(df)
    validate(df)
    df.to_csv(path_out, index=False)
    end = time.time()
    print("\nCleaning finished in", round(end - start, 2), "seconds")
clean_data_project("real_dataset.csv", "cleaned_dataset.csv")
